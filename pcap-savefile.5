.\" Авторское право (c) 1994, 1996, 1997
.\"	Регенты Калифорнийского университета.  Все права защищены.
.\"
.\" Распространение и использование в исходных и двоичных формах, с модификацией или без
.\" модификацией, разрешены при условии, что: (1) при распространении исходного кода
.\" сохраняют вышеуказанное уведомление об авторских правах и данный параграф в полном объеме, (2)
.\" дистрибутивы, включающие двоичный код, содержат вышеуказанное уведомление об авторских правах и
.\" этот пункт в полном объеме в документации или других материалах
.\", предоставляемых вместе с дистрибутивом, и (3) все рекламные материалы, в которых упоминаются
.\" возможности или использование этого программного обеспечения, содержат следующее подтверждение:
.\" ``Этот продукт содержит программное обеспечение, разработанное Калифорнийским университетом,
.\" Лабораторией Лоренса Беркли и его соавторами''. Ни название
.\" университета, ни имена его авторов не могут быть использованы для одобрения
.\" или для рекламы продуктов, созданных на основе этого программного обеспечения, без специального предварительного
.\" письменного разрешения.
.\" ДАННОЕ ПРОГРАММНОЕ ОБЕСПЕЧЕНИЕ ПРЕДОСТАВЛЯЕТСЯ ``КАК ЕСТЬ`` И БЕЗ КАКИХ-ЛИБО ЯВНЫХ ИЛИ ПОДРАЗУМЕВАЕМЫХ
.\" ГАРАНТИЙ, ВКЛЮЧАЯ, БЕЗ ОГРАНИЧЕНИЙ, ПОДРАЗУМЕВАЕМЫЕ ГАРАНТИИ
.\" ТОВАРНОГО СОСТОЯНИЯ И ПРИГОДНОСТИ ДЛЯ КОНКРЕТНОЙ ЦЕЛИ.
.\"
.TH PCAP-SAVEFILE 5 "24 апреля 2020 г."
.SH ИМЯ
pcap-savefile \- формат файла сохранения libpcap
ОПИСАНИЕ .SH
ПРИМЕЧАНИЕ: приложения и библиотеки должны, по возможности, использовать libpcap для
для чтения файлов сохранения, а не создавать свой собственный код для чтения файлов сохранения.
Если в будущем libpcap будет поддерживать новый формат файлов,
приложения и библиотеки, использующие libpcap для чтения savefiles, смогут
читать новый формат savefiles, но приложения и библиотеки
использующие свой собственный код для чтения файлов сохранения, должны будут изменить его для
поддержку нового формата файлов.
.PP
Файлы сохранения, считываемые и записываемые libpcap и приложениями, использующими libpcap
начинаются с заголовка каждого файла.  Формат заголовка для каждого файла следующий:
.RS
.TS
box;
c s
c | c
c s.
Магическое число
_
Мажорная версия Минорная версия
_
Смещение часового пояса
_
Точность метки времени
_
Длина моментального снимка
_
Тип заголовка канального уровня
.TE
.RE
.PP
Длина заголовка для каждого файла составляет 24 октета.
.PP
Все поля в заголовке каждого файла расположены в порядке байтов хоста
записывающего файл.  Обычно первым полем в заголовке каждого файла является
4-байтовое магическое число со значением 0xa1b2c3d4.  Магическое число, когда
прочитанное хостом с тем же порядком байтов, что и у хоста, написавшего файл,
будет иметь значение 0xa1b2c3d4, а при чтении хостом с
противоположным порядком байтов, чем у хоста, написавшего файл, будет иметь значение
0xd4c3b2a1.  Это позволяет программному обеспечению, читающему файл, определить
порядок байтов хоста, написавшего файл, совпадает с порядком байтов
порядок байт хоста, на котором читается файл, и, следовательно, соответствуют ли значения
значения в заголовках для каждого файла и каждого пакета нужно поменять местами.
.PP
Если магическое число имеет значение 0xa1b23c4d (с двумя полубайтами
два младших байта магического числа поменяны местами), которое будет
прочитано как 0xa1b23c4d хостом с тем же порядком байтов, что и у хоста, который
и как 0x4d3cb2a1 хостом с противоположным порядком байтов.
как у хоста, написавшего файл, формат файла такой же, как у
обычных файлов, за исключением того, что временные метки для пакетов указываются в
секундах и наносекундах, а не в секундах и микросекундах.
.PP
За ним следуют:
.IP
2-байтовый номер основной версии формата файла; текущий номер версии -
2.
.IP
2-байтовый номер младшей версии формата файла; текущий номер версии
4.
.IP
4-байтовое смещение часового пояса; оно всегда равно 0.
.IP
4-байтовое число, определяющее точность временных меток в файле; всегда равно
всегда 0.
.IP
4-байтовое число, определяющее "длину моментального снимка" захвата; пакеты
длиннее длины моментального снимка усекаются до длины моментального снимка, так что
поэтому, если длина моментального снимка равна
.IR N ,
только первый
.I N
байтов пакета, длина которого превышает
.I N
байт будут сохранены в захвате.
.IP
4-байтовое число, указывающее тип заголовка канального уровня для пакетов в
захвате; см.
.BR pcap-linktype (7)
для
.B LINKTYPE_
значения, которые могут появляться в этом поле.
.PP
После заголовка файла следует ноль или более пакетов; каждый пакет
начинается с заголовка пакета, за которым сразу следуют
необработанные данные пакета.  Формат заголовка каждого пакета следующий:
.RS
.TS
коробка;
c.
Метка времени, значение в секундах
_
Временная метка, значение микросекунд или наносекунд
_
Длина захваченного пакета данных
_
Необрезанная длина данных пакета
.TE
.RE
.PP
Длина заголовка каждого пакета составляет 16 октетов.
.PP
Все поля в заголовке каждого пакета расположены в порядке байтов хоста
записывающего файл.  Заголовок каждого пакета начинается с метки времени, указывающей
приблизительное время захвата пакета; метка времени состоит из
4-байтового значения, дающего время в секундах с 1 января 1970 года,
00:00:00 UTC, за которым следует 4-байтовое значение, указывающее время в секундах с 1 января 1970 года, 00:00:00 UTC, а затем 4-байтовое значение, указывающее время в
микросекундах или наносекундах, прошедших с этой секунды, в зависимости от магического
числа в заголовке файла.За ним следует 4-байтовое значение, указывающее
количество байт захваченных данных, которые следуют за заголовком каждого пакета, и
4-байтовое значение, дающее количество байтов, которые присутствовали бы в пакете, если бы
если бы пакет не был обрезан по длине моментального снимка.  Эти две длины
будут равны, если количество байт данных пакета меньше или
равно длине моментального снимка.
.SH СМОТРИТЕ ТАКЖЕ
.BR pcap (3)

 

